<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Administra√ß√£o - GameRivals</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/pages.css">
    <link rel="stylesheet" href="css/cards.css">
    <link rel="stylesheet" href="css/chat-and-friends.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="stylesheet" href="css/theme-and-utils.css">
    </head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1><a href="dashboard.html"><img src="img/logo-gamerivals.png" alt="Game Rivals Logo"></a></h1>
            </div>

            <nav>
                <ul id="main-nav-links">
                    <li class="mobile-user-info-section" style="display: none;">
                        <div class="mobile-user-profile-summary">
                            <img src="img/avatar-placeholder.png" alt="Avatar do Usu√°rio" class="user-avatar">
                            <span class="username">Visitante</span>
                        </div>
                        <div class="mobile-user-stats-wallet">
                             <div class="wallet-info">
                                <span class="coin-icon">üí∞</span>
                                <span class="coin-balance">0</span>
                            </div>
                            <div class="user-stats">
                                <span>üèÜ<span>0</span></span>
                                <span>‚ò†Ô∏è<span>0</span></span>
                            </div>
                        </div>
                    </li>

                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="#" id="admin-logout-button" class="nav-button">Sair Admin</a></li>
                </ul>
            </nav>

            <button class="hamburger-menu" aria-label="Abrir menu" aria-expanded="false">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <div class="user-nav-desktop" style="display: none;"></div>
        </div>
    </header>

    <main class="admin-main">
        <h2>Painel de Administra√ß√£o</h2>

        <section id="admin-dashboard-overview">
            <h3>Vis√£o Geral do Site</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <h4>Total de Usu√°rios</h4>
                    <p id="total-users">0</p>
                </div>
                <div class="stat-card">
                    <h4>Usu√°rios Online</h4>
                    <p id="online-users-count">0</p>
                </div>
                <div class="stat-card">
                    <h4>Desafios Criados</h4>
                    <p id="total-challenges">0</p>
                </div>
                <div class="stat-card">
                    <h4>Desafios Completos</h4>
                    <p id="completed-challenges">0</p>
                </div>
                <div class="stat-card">
                    <h4>Desafios em Disputa</h4>
                    <p id="disputed-challenges">0</p>
                </div>
                <div class="stat-card">
                    <h4>Moedas Apostadas</h4>
                    <p id="total-coins-bet">0</p>
                </div>
                <div class="stat-card">
                    <h4>Total de Torneios</h4>
                    <p id="total-tournaments">0</p>
                </div>
                <div class="stat-card">
                    <h4>Torneios Ativos</h4>
                    <p id="active-tournaments">0</p>
                </div>
            </div>
        </section>

        <section id="admin-tournament-management">
            <h3>Gerenciamento de Campeonatos</h3>
            <div style="margin-bottom: 20px;">
                <button id="open-create-tournament-modal-btn" class="cta-button">Criar Novo Campeonato</button>
            </div>
            <div class="table-container">
                <table id="tournaments-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nome</th>
                            <th>Jogo</th>
                            <th>Aposta</th>
                            <th>Participantes</th>
                            <th>M√°x. Part.</th>
                            <th>Status</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </section>
        
        <section id="admin-game-management">
            <h3>Gerenciamento de Jogos</h3>
            <div style="margin-bottom: 20px;">
                <button id="open-create-game-modal-btn" class="cta-button">Adicionar Novo Jogo</button>
            </div>
            <div class="table-container">
                <table id="games-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Jogo</th>
                            <th>Icon URL</th>
                            <th>Consoles Suportados</th>
                            <th>Ativo</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </section>

        <section id="admin-withdrawal-management">
            <h3>Gerenciamento de Saques</h3>
            <p style="color: var(--text-muted); margin-bottom: 20px;">
                Estas s√£o as solicita√ß√µes de saque pendentes que precisam de sua aprova√ß√£o.
            </p>
            <div class="table-container">
                <table id="withdrawals-table">
                    <thead>
                        <tr>
                            <th>ID Saque</th>
                            <th>ID Usu√°rio</th>
                            <th>Nome de Usu√°rio</th>
                            <th>CPF</th>
                            <th>Valor</th>
                            <th>Tipo de Chave</th>
                            <th>Chave Pix</th>
                            <th>Solicitado em</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </section>

        <section id="admin-user-management">
            <h3>Gerenciamento de Usu√°rios</h3>
            <div class="table-container">
                <table id="users-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nome</th>
                            <th>Email</th>
                            <th>Registro</th>
                            <th>Vit√≥rias</th>
                            <th>Derrotas</th>
                            <th>Moedas</th>
                            <th>Ativo</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </section>

        <section id="admin-challenge-management">
            <h3>Gerenciamento de Desafios</h3>
            <div class="table-container">
                <table id="challenges-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Jogo</th>
                            <th>Console</th>
                            <th>Aposta</th>
                            <th>Criado Por</th>
                            <th>Oponente</th>
                            <th>Status</th>
                            <th>Vencedor</th>
                            <th>Cria√ß√£o</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </section>

        <section id="admin-pix-payments">
            <h3>Gerenciamento de Pagamentos Pix</h3>
            <p style="color: var(--text-muted); margin-bottom: 20px;">
                Estas s√£o as notifica√ß√µes de pagamento que precisam de sua verifica√ß√£o manual.
            </p>
            <div class="table-container">
                <table id="pix-payments-table">
                    <thead>
                        <tr>
                            <th>ID Pagamento</th>
                            <th>ID Usu√°rio</th>
                            <th>Email</th>
                            <th>Valor</th>
                            <th>Notificado em</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; <span id="currentYear"></span> GameRivals Admin. Todos os direitos reservados.</p>
            <ul>
                <li><a href="#">Termos de Uso</a></li>
                <li><a href="#">Pol√≠tica de Privacidade</a></li>
                <li><a href="#">Contato</a></li>
            </ul>
        </div>
    </footer>

    <div class="modal-backdrop" id="edit-coins-modal-backdrop">
        <div class="modal">
            <button class="close-modal-btn">&times;</button>
            <h2>Editar Moedas do Usu√°rio</h2>
            <form id="edit-coins-form" class="modal-form">
                <p>Usu√°rio: <strong id="edit-coins-username"></strong></p>
                <div class="input-group">
                    <label for="new-coins-amount">Novo Saldo de Moedas</label>
                    <input type="number" id="new-coins-amount" name="newCoinsAmount" min="0" required>
                </div>
                <input type="hidden" id="edit-coins-user-id">
                <p class="form-error-message" id="edit-coins-error"></p>
                <button type="submit" class="cta-button form-submit-btn">Salvar Moedas</button>
            </form>
        </div>
    </div>

    <div class="modal-backdrop" id="resolve-dispute-modal-backdrop">
        <div class="modal">
            <button class="close-modal-btn">&times;</button>
            <h2>Resolver Disputa de Desafio</h2>
            <p>Desafio: <strong id="dispute-challenge-info"></strong></p>
            <p>Criado por: <span id="dispute-creator-username"></span> (ID: <span id="dispute-creator-id"></span>)</p>
            <p>Oponente: <span id="dispute-opponent-username"></span> (ID: <span id="dispute-opponent-id"></span>)</p>
            <div id="dispute-winner-options"></div>
            <form id="resolve-dispute-form" class="modal-form">
                <input type="hidden" id="dispute-challenge-id">
            </form>
            <span id="resolve-dispute-error" style="color: red;"></span>
        </div>
    </div>

    <div class="modal-backdrop" id="reject-withdrawal-modal-backdrop">
        <div class="modal" id="reject-withdrawal-modal">
            <button class="close-modal-btn">&times;</button>
            <h2>Rejeitar Saque</h2>
            <p>Tem certeza que deseja rejeitar o saque de <strong id="reject-withdrawal-amount"></strong> moedas?</p>
            <p>O valor ser√° estornado para a conta do usu√°rio.</p>
            <div class="modal-actions-profile" style="margin-top: 20px;">
                <button class="cta-button form-submit-btn" id="confirm-reject-withdrawal-btn" style="background-color: var(--loss-color);">Confirmar Rejei√ß√£o</button>
                <button class="cta-button form-submit-btn" id="cancel-reject-withdrawal-btn" style="background-color: var(--text-muted);">Cancelar</button>
            </div>
        </div>
    </div>

    <div class="modal-backdrop" id="create-tournament-modal-backdrop">
        <div class="modal" id="create-tournament-modal">
            <button class="close-modal-btn">&times;</button>
            <h2>Criar Novo Campeonato</h2>
            <form id="create-tournament-form" class="modal-form">
                <div class="input-group">
                    <label for="tournament-name">Nome do Campeonato</label>
                    <input type="text" id="tournament-name" name="name" required>
                </div>
                 <div class="input-group">
                    <label for="tournament-game-select">Jogo</label>
                    <select id="tournament-game-select" name="game" required>
                        <option value="" disabled selected>Selecione um jogo</option>
                        <option value="Ea Sports 24">Ea Sports 24</option>
                        <option value="Ea Sports 25">Ea Sports 25</option>
                        <option value="Rocket League">Rocket League</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="tournament-console-select">Console</label>
                    <select id="tournament-console-select" name="console" required>
                        <option value="" disabled selected>Selecione um console</option>
                        <option value="PS5">PlayStation 5</option>
                        <option value="PS4">PlayStation 4</option>
                        <option value="XBOX Series">Xbox Series S/X</option>
                        <option value="Xbox One">Xbox One</option>
                        <option value="PC">PC</option>
                        <option value="Nintendo Switch">Nintendo Switch</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="tournament-bet-amount">Valor da Inscri√ß√£o (em moedas)</label>
                    <input type="number" id="tournament-bet-amount" name="betAmount" min="0" value="0" required>
                    <small style="color: var(--text-muted);">Digite 0 para campeonato gratuito.</small>
                </div>
                <div class="input-group">
                    <label for="tournament-max-participants">M√°x. de Participantes</label>
                    <select id="tournament-max-participants" name="maxParticipants" required>
                        <option value="" disabled selected>Selecione a quantidade</option>
                        <option value="8">8</option>
                        <option value="16">16</option>
                        <option value="32">32</option>
                        <option value="64">64</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="tournament-scheduled-time">Hor√°rio Agendado (Opcional)</label>
                    <input type="text" id="tournament-scheduled-time" name="scheduledTime" placeholder="Ex: 20/09/2025 √†s 20:00">
                </div>
                <p class="form-error-message" id="create-tournament-error"></p>
                <button type="submit" class="cta-button form-submit-btn">Criar Campeonato</button>
            </form>
        </div>
    </div>

    <div class="modal-backdrop" id="manage-tournament-modal-backdrop">
        <div class="modal" id="manage-tournament-modal">
            <button class="close-modal-btn">&times;</button>
            <h2 id="manage-tournament-title">Gerenciar Campeonato</h2>
            
            <div style="margin-bottom: 20px;">
                <button id="start-tournament-btn" class="cta-button" style="background-color: var(--win-color);">Iniciar Campeonato</button>
                <button id="send-message-btn" class="cta-button" style="background-color: var(--secondary-neon);">Enviar Mensagem</button>
            </div>
            
            <div id="tournament-bracket-display" style="display: none;">
                <h3>Chaveamento</h3>
                </div>
            
            <h3>Participantes (<span id="tournament-participants-count">0</span>/<span id="tournament-max-participants-count">0</span>)</h3>
            <ul id="tournament-participants-list" class="player-list" style="margin-bottom: 20px;">
                </ul>
        </div>
    </div>

    <div class="modal-backdrop" id="send-message-modal-backdrop">
        <div class="modal" id="send-message-modal">
            <button class="close-modal-btn">&times;</button>
            <h2>Enviar Mensagem para Participantes</h2>
            <form id="send-message-form" class="modal-form">
                <p>Campeonato: <strong id="message-tournament-name"></strong></p>
                <div class="input-group">
                    <label for="message-text">Mensagem</label>
                    <textarea id="message-text" name="message" rows="5" required></textarea>
                </div>
                <input type="hidden" id="message-tournament-id">
                <p class="form-error-message" id="send-message-error"></p>
                <button type="submit" class="cta-button form-submit-btn">Enviar</button>
            </form>
        </div>
    </div>

    <div class="modal-backdrop" id="manage-game-modal-backdrop">
        <div class="modal" id="manage-game-modal">
            <button class="close-modal-btn">&times;</button>
            <h2 id="manage-game-title">Adicionar Novo Jogo</h2>
            <form id="manage-game-form" class="modal-form">
                <input type="hidden" id="game-id-to-manage">
                
                <div class="input-group">
                    <label for="game-name">Nome do Jogo</label>
                    <input type="text" id="game-name" name="name" required>
                </div>
                <div class="input-group">
                    <label for="game-icon-url">URL do √çcone (Imagem)</label>
                    <input type="url" id="game-icon-url" name="iconUrl" placeholder="Ex: /img/rl.jpg">
                </div>
                <div class="input-group">
                    <label>Consoles Suportados</label>
                    <div id="supported-consoles-checkboxes" style="display: flex; flex-wrap: wrap; gap: 15px;">
                        </div>
                </div>
                
                <div class="input-group" id="game-active-toggle-group" style="display: none;">
                    <label for="game-is-active">Status</label>
                    <select id="game-is-active" name="isActive">
                        <option value="true">Ativo</option>
                        <option value="false">Inativo</option>
                    </select>
                </div>

                <p class="form-error-message" id="manage-game-error"></p>
                <button type="submit" class="cta-button form-submit-btn" id="save-game-btn">Salvar Jogo</button>
            </form>
        </div>
    </div>
    
    <div id="notification-container"></div>
    <script src="https://gamerivals-site.onrender.com/socket.io/socket.io.js"></script> <script src="js/main.js"></script> <script type="module" src="js/admin.js"></script>
</body>
</html>